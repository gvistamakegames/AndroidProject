package Class;

import java.io.IOException;

import android.content.res.AssetFileDescriptor;
import android.media.MediaPlayer;
import android.media.MediaPlayer.OnCompletionListener;

import com.baseproject.framework.Interface.Music;

public class AndroidMusic implements Music, OnCompletionListener {

	// 変数宣言
	MediaPlayer mediaPlayer;
	boolean isPrepared = false;
	
	public AndroidMusic( AssetFileDescriptor assetDescriptor ){
		
		mediaPlayer = new MediaPlayer();
		
		try{
			
			mediaPlayer.setDataSource( assetDescriptor.getFileDescriptor(), assetDescriptor.getStartOffset(), assetDescriptor.getLength() );
			mediaPlayer.prepare();
			isPrepared = true;
			mediaPlayer.setOnCompletionListener( this );
			
		}catch( Exception e ){
 			
			throw new RuntimeException( "音楽データをロードできませんでした" );
			
		}
		
	}
	
	@Override
	public void dispose(){
		
		if( mediaPlayer.isPlaying() ){
			mediaPlayer.stop();
		}
		
		mediaPlayer.release();
				
	}
	
	@Override
	public boolean isLooping(){
		
		return mediaPlayer.isLooping();
		
	}
	
	@Override
	public boolean isPlaying(){
		
		return mediaPlayer.isPlaying();
		
	}
	
	@Override
	public boolean isStopped(){
		
		return !isPrepared;
		
	}	
	
	
	
	
	
	
}
